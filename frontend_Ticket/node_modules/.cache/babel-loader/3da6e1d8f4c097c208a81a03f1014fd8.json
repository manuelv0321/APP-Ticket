{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\laragon\\\\www\\\\restapis_crm_frontend-master\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\laragon\\\\www\\\\restapis_crm_frontend-master\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\laragon\\\\www\\\\restapis_crm_frontend-master\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\laragon\\\\www\\\\restapis_crm_frontend-master\\\\src\\\\componentes\\\\productos\\\\Productos.js\";\nimport React, { useEffect, useState, useContext, Fragment } from 'react';\nimport { Link } from 'react-router-dom'; // importar cliente axios\n\nimport clienteAxios from '../../config/axios';\nimport Producto from './Producto';\nimport Spinner from '../layout/Spinner'; // import el Context\n\nimport { CRMContext } from '../../context/CRMContext';\n\nfunction Productos(props) {\n  // productos = state, guardarproductos = funcion para guardar el state\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      productos = _useState2[0],\n      guardarProductos = _useState2[1]; // utilizar valores del context\n\n\n  var _useContext = useContext(CRMContext),\n      _useContext2 = _slicedToArray(_useContext, 2),\n      auth = _useContext2[0],\n      guardarAuth = _useContext2[1]; // useEffect para consultar api cuando cargue\n\n\n  useEffect(function () {\n    if (auth.token !== '') {\n      // Query a la API\n      var consultarAPI =\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee() {\n          var productosConsulta;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.prev = 0;\n                  _context.next = 3;\n                  return clienteAxios.get('/productos', {\n                    headers: {\n                      Authorization: \"Bearer \".concat(auth.token)\n                    }\n                  });\n\n                case 3:\n                  productosConsulta = _context.sent;\n                  guardarProductos(productosConsulta.data);\n                  _context.next = 10;\n                  break;\n\n                case 7:\n                  _context.prev = 7;\n                  _context.t0 = _context[\"catch\"](0);\n\n                  // Error con authorizacion\n                  if (_context.t0.response.status = 500) {\n                    props.history.push('/iniciar-sesion');\n                  }\n\n                case 10:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, null, [[0, 7]]);\n        }));\n\n        return function consultarAPI() {\n          return _ref.apply(this, arguments);\n        };\n      }(); // llamado a la api\n\n\n      consultarAPI();\n    } else {\n      props.history.push('/iniciar-sesion');\n    }\n  }, [productos]); // Si el state esta como false\n\n  if (!auth.auth) {\n    props.history.push('/iniciar-sesion');\n  } // spinner de carga\n\n\n  if (!productos.length) return React.createElement(Spinner, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  });\n  return React.createElement(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, \"Productos\"), React.createElement(Link, {\n    to: '/productos/nuevo',\n    className: \"btn btn-verde nvo-cliente\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"fas fa-plus-circle\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }), \"Nuevo Producto\"), React.createElement(\"ul\", {\n    className: \"listado-productos\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }, productos.map(function (producto) {\n    return React.createElement(Producto, {\n      key: producto._id,\n      producto: producto,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    });\n  })));\n}\n\nexport default Productos;","map":{"version":3,"sources":["C:\\laragon\\www\\restapis_crm_frontend-master\\src\\componentes\\productos\\Productos.js"],"names":["React","useEffect","useState","useContext","Fragment","Link","clienteAxios","Producto","Spinner","CRMContext","Productos","props","productos","guardarProductos","auth","guardarAuth","token","consultarAPI","get","headers","Authorization","productosConsulta","data","response","status","history","push","length","map","producto","_id"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,QAA1B,EAAoCC,UAApC,EAAiDC,QAAjD,QAAgE,OAAhE;AACA,SAASC,IAAT,QAAqB,kBAArB,C,CACA;;AACA,OAAOC,YAAP,MAAyB,oBAAzB;AACA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,OAAP,MAAoB,mBAApB,C,CAEA;;AACA,SAASC,UAAT,QAA2B,0BAA3B;;AAEA,SAASC,SAAT,CAAmBC,KAAnB,EAA0B;AAEtB;AAFsB,kBAGgBT,QAAQ,CAAC,EAAD,CAHxB;AAAA;AAAA,MAGfU,SAHe;AAAA,MAGJC,gBAHI,kBAKtB;;;AALsB,oBAMOV,UAAU,CAAEM,UAAF,CANjB;AAAA;AAAA,MAMfK,IANe;AAAA,MAMTC,WANS,oBAQtB;;;AACAd,EAAAA,SAAS,CAAE,YAAM;AAEb,QAAGa,IAAI,CAACE,KAAL,KAAe,EAAlB,EAAsB;AAClB;AACA,UAAMC,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,iCAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAEmBX,YAAY,CAACY,GAAb,CAAiB,YAAjB,EAA+B;AAC3DC,oBAAAA,OAAO,EAAE;AACLC,sBAAAA,aAAa,mBAAaN,IAAI,CAACE,KAAlB;AADR;AADkD,mBAA/B,CAFnB;;AAAA;AAEPK,kBAAAA,iBAFO;AAObR,kBAAAA,gBAAgB,CAACQ,iBAAiB,CAACC,IAAnB,CAAhB;AAPa;AAAA;;AAAA;AAAA;AAAA;;AASb;AACA,sBAAG,YAAMC,QAAN,CAAeC,MAAf,GAAwB,GAA3B,EAAgC;AAC5Bb,oBAAAA,KAAK,CAACc,OAAN,CAAcC,IAAd,CAAmB,iBAAnB;AACH;;AAZY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAH;;AAAA,wBAAZT,YAAY;AAAA;AAAA;AAAA,SAAlB,CAFkB,CAiBlB;;;AACAA,MAAAA,YAAY;AAEf,KApBD,MAoBO;AACHN,MAAAA,KAAK,CAACc,OAAN,CAAcC,IAAd,CAAmB,iBAAnB;AACH;AACJ,GAzBQ,EAyBN,CAACd,SAAD,CAzBM,CAAT,CATsB,CAoCtB;;AACA,MAAG,CAACE,IAAI,CAACA,IAAT,EAAe;AACXH,IAAAA,KAAK,CAACc,OAAN,CAAcC,IAAd,CAAmB,iBAAnB;AACH,GAvCqB,CA0CtB;;;AACA,MAAG,CAACd,SAAS,CAACe,MAAd,EAAsB,OAAO,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAP;AAGtB,SACI,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADJ,EAGI,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAE,kBAAV;AAA8B,IAAA,SAAS,EAAC,2BAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAG,IAAA,SAAS,EAAC,oBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,mBAHJ,EAQI;AAAI,IAAA,SAAS,EAAC,mBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKf,SAAS,CAACgB,GAAV,CAAc,UAAAC,QAAQ;AAAA,WACnB,oBAAC,QAAD;AACI,MAAA,GAAG,EAAEA,QAAQ,CAACC,GADlB;AAEI,MAAA,QAAQ,EAAED,QAFd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADmB;AAAA,GAAtB,CADL,CARJ,CADJ;AAmBH;;AACD,eAAenB,SAAf","sourcesContent":["import React, {useEffect, useState, useContext,  Fragment} from 'react';\nimport { Link } from 'react-router-dom';\n// importar cliente axios\nimport clienteAxios from '../../config/axios';\nimport Producto from './Producto';\nimport Spinner from '../layout/Spinner';\n\n// import el Context\nimport { CRMContext } from '../../context/CRMContext';\n\nfunction Productos(props) {\n\n    // productos = state, guardarproductos = funcion para guardar el state\n    const [productos, guardarProductos] = useState([]);\n\n    // utilizar valores del context\n    const [auth, guardarAuth ] = useContext( CRMContext );\n\n    // useEffect para consultar api cuando cargue\n    useEffect( () => {\n\n        if(auth.token !== '') {\n            // Query a la API\n            const consultarAPI = async () => {\n                try {\n                    const productosConsulta = await clienteAxios.get('/productos', {\n                        headers: {\n                            Authorization : `Bearer ${auth.token}`\n                        }\n                    });\n                    guardarProductos(productosConsulta.data);\n                } catch (error) {\n                    // Error con authorizacion\n                    if(error.response.status = 500) {\n                        props.history.push('/iniciar-sesion');\n                    }\n                }\n            }\n            // llamado a la api\n            consultarAPI();\n\n        } else {\n            props.history.push('/iniciar-sesion');\n        }\n    }, [productos]);\n\n    // Si el state esta como false\n    if(!auth.auth) {\n        props.history.push('/iniciar-sesion');\n    }\n\n\n    // spinner de carga\n    if(!productos.length) return <Spinner /> \n\n\n    return (\n        <Fragment>\n            <h2>Productos</h2>\n\n            <Link to={'/productos/nuevo'} className=\"btn btn-verde nvo-cliente\"> \n                <i className=\"fas fa-plus-circle\"></i>\n                Nuevo Producto\n            </Link>\n\n            <ul className=\"listado-productos\">\n                {productos.map(producto => (\n                    <Producto \n                        key={producto._id}\n                        producto={producto}\n                    />\n                ))}\n            </ul>\n        </Fragment>\n    )\n}\nexport default Productos;"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _toConsumableArray from \"C:\\\\laragon\\\\www\\\\frontend_Ticket\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"C:\\\\laragon\\\\www\\\\frontend_Ticket\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"C:\\\\laragon\\\\www\\\\frontend_Ticket\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"C:\\\\laragon\\\\www\\\\frontend_Ticket\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\laragon\\\\www\\\\frontend_Ticket\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\laragon\\\\www\\\\frontend_Ticket\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\laragon\\\\www\\\\frontend_Ticket\\\\src\\\\componentes\\\\Ticket\\\\NuevoTicket.js\";\nimport React, { Fragment, useState, useEffect } from 'react';\nimport Swal from 'sweetalert2';\nimport { Link, withRouter } from 'react-router-dom';\nimport clienteAxios from '../../config/axios';\nimport DataTable from 'react-data-table-component';\nimport nextId from \"react-id-generator\";\n\nfunction NuevoTicket(_ref) {\n  var history = _ref.history;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      usuarios = _useState2[0],\n      guardarUsuarios = _useState2[1];\n\n  useEffect(function () {\n    var token = localStorage.getItem('token', token); // Query a la API\n\n    var consultarAPI =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var clientesConsulta;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return clienteAxios.get('/clientes', {\n                  headers: {\n                    Authorization: \"Bearer \".concat(token)\n                  }\n                });\n\n              case 3:\n                clientesConsulta = _context.sent;\n                console.log(clientesConsulta); // colocar el resultado en el state\n\n                guardarUsuarios(clientesConsulta.data);\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n\n                // Error con authorizacion\n                if (_context.t0.response.status = 500) {\n                  history.push('/iniciar-sesion');\n                }\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n\n      return function consultarAPI() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    consultarAPI();\n  }, []); // cliente = state, guardarcliente = funcion para guardar el state\n\n  var _useState3 = useState({\n    Subject: '',\n    Description: '',\n    start: '',\n    dateend: '',\n    hour: ''\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      cliente = _useState4[0],\n      guardarCliente = _useState4[1]; // leer los datos del formulario\n\n\n  var actualizarState = function actualizarState(e) {\n    // Almacenar lo que el usuario escribe en el state\n    guardarCliente(_objectSpread({}, cliente, _defineProperty({}, e.target.name, e.target.value)));\n  }; // Añade en la REST API un cliente nuevo\n\n\n  var agregarCliente = function agregarCliente(e) {\n    e.preventDefault();\n    var Ticket = {};\n    Ticket.cliente = cliente;\n    Ticket.Usuarios = users; // enviar petición\n\n    clienteAxios.post('/Tickets', Ticket, {\n      headers: {\n        Authorization: \"Bearer \".concat(localStorage.getItem('token'))\n      }\n    }).then(function (res) {\n      // validar si hay errores de mongo \n      if (res.data === 'No Autenticado, no hay JWT') {\n        Swal.fire({\n          type: 'error',\n          title: 'Hubo un error',\n          text: 'Token expirado o no existe'\n        });\n        history.push('/iniciar-sesion');\n      } else {\n        Swal.fire('Se agregó el Cliente', res.data.mensaje, 'success');\n      } // Redireccionar\n\n\n      history.push('/');\n    });\n  }; // Validar el formulario\n\n\n  var validarCliente = function validarCliente() {\n    // Destructuring\n    var Subject = cliente.Subject,\n        Description = cliente.Description,\n        start = cliente.start,\n        dateend = cliente.dateend,\n        user = cliente.user; // revisar que las propiedades del state tengan contenido\n\n    var valido = !Subject.length || !Description.length || !start.length || !dateend.length; // return true o false\n\n    return valido;\n  }; //asignar usuario\n  // verificar si el usuario esta autenticado o no\n\n\n  if (localStorage.getItem('token') === '') {\n    history.push('/iniciar-sesion');\n  }\n\n  var _useState5 = useState(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      user = _useState6[0],\n      setuser = _useState6[1];\n\n  var _useState7 = useState(['0']),\n      _useState8 = _slicedToArray(_useState7, 2),\n      users = _useState8[0],\n      setUsers = _useState8[1];\n\n  var _useState9 = useState({\n    id: 0\n  }),\n      _useState10 = _slicedToArray(_useState9, 2),\n      uses = _useState10[0],\n      setUses = _useState10[1]; //  const [guardaruser, setguardaruser] = useState(guardaruser);\n\n\n  var asignar = function asignar(id) {\n    setUsers(function (users) {\n      return [].concat(_toConsumableArray(users), [id]);\n    });\n\n    if (users.length == 2) {\n      users.splice(0, 1);\n    } else {\n      users.splice(0, 1);\n      var arrFiltrado = users.filter(function (num) {\n        return num % 2 == 0;\n      });\n      users.splice(arrFiltrado, 1);\n    }\n\n    console.log(users);\n  };\n\n  var columna = [{\n    name: 'ID',\n    selector: 'id',\n    sortable: true\n  }, {\n    name: 'action',\n    cell: function cell(id) {\n      return React.createElement(React.Fragment, null, React.createElement(\"span\", {\n        onClick: function onClick() {\n          return Finish(id);\n        },\n        className: \"btn btn-verde\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, \"E\"));\n    }\n  }];\n\n  var Finish = function Finish(id) {\n    Swal.fire({\n      title: '¿Estás seguro?',\n      text: \"Seguro quieres Finalizar este Ticket?\",\n      type: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#3085d6',\n      cancelButtonColor: '#d33',\n      confirmButtonText: 'Si, Finalizar',\n      cancelButtonText: 'No, Cancelar'\n    }).then(function (result) {\n      if (result.value) {\n        clienteAxios.post('/Ticket', id, {\n          headers: {\n            Authorization: \"Bearer \".concat(localStorage.getItem('token'))\n          }\n        }).then(function (res) {\n          console.log(res);\n\n          if (res.status === 200) {\n            Swal.fire('Eliminado', res.data.mensaje, 'success');\n          } else {\n            history.push('/iniciar-sesion');\n          }\n        });\n      }\n    });\n  };\n\n  return React.createElement(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, React.createElement(Link, {\n    to: \"/\",\n    className: \"btn btn-verde nvo-cliente\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205\n    },\n    __self: this\n  }, \"Home\"), React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  }, \"Nuevo Ticket\"), React.createElement(\"form\", {\n    onSubmit: agregarCliente,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }, React.createElement(\"legend\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  }, \"Llena todos los campos\"), React.createElement(\"div\", {\n    className: \"campo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }, \"Subject:\"), React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Subject\",\n    name: \"Subject\",\n    onChange: actualizarState,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"campo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  }, \"Description:\"), React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Description\",\n    name: \"Description\",\n    onChange: actualizarState,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"campo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }, \"date start:\"), React.createElement(\"input\", {\n    type: \"date\",\n    placeholder: \"Empresa Cliente\",\n    name: \"start\",\n    onChange: actualizarState,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"campo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243\n    },\n    __self: this\n  }, \"date end:\"), React.createElement(\"input\", {\n    type: \"date\",\n    placeholder: \"Email Cliente\",\n    name: \"dateend\",\n    onChange: actualizarState,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"campo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252\n    },\n    __self: this\n  }, \"hour:\"), React.createElement(\"input\", {\n    type: \"text\",\n    onKeyPress: function onKeyPress(event) {\n      if (!/[0-9]/.test(event.key)) {\n        event.preventDefault();\n      }\n    },\n    placeholder: \"Hour\",\n    name: \"hour\",\n    onChange: actualizarState,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"campo left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269\n    },\n    __self: this\n  }, \"Usuario:\"), React.createElement(\"select\", {\n    className: \"campo\",\n    name: \"user\",\n    value: user,\n    onChange: function onChange(e) {\n      var user = e.target.value;\n      setuser(user);\n\n      if (users.length > 1) {\n        setUsers([].concat(_toConsumableArray(users), [parseInt(user)]));\n        console.log(users);\n      } else {\n        // setUsers([0]);\n        setUsers([].concat(_toConsumableArray(users), [parseInt(user)]));\n        console.log(users);\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    value: \"0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290\n    },\n    __self: this\n  }, \"Seleccionar\"), usuarios.map(function (usuario, index) {\n    return React.createElement(\"option\", {\n      key: usuario.id,\n      value: usuario.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, usuario.name);\n  })), React.createElement(\"button\", {\n    type: \"button\",\n    className: \"right \",\n    onClick: function onClick() {\n      return asignar(user);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302\n    },\n    __self: this\n  }, \"+\")), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310\n    },\n    __self: this\n  }), React.createElement(DataTable, {\n    columns: columna,\n    data: uses,\n    title: \"Listado De user\",\n    key: nextId(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"enviar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"submit\",\n    className: \"btn btn-azul\",\n    value: \"Crear Ticket\",\n    disabled: validarCliente(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324\n    },\n    __self: this\n  }))));\n} // HOC, es una función que toma un componente y retorna un nuevo componente\n\n\nexport default withRouter(NuevoTicket);","map":{"version":3,"sources":["C:\\laragon\\www\\frontend_Ticket\\src\\componentes\\Ticket\\NuevoTicket.js"],"names":["React","Fragment","useState","useEffect","Swal","Link","withRouter","clienteAxios","DataTable","nextId","NuevoTicket","history","usuarios","guardarUsuarios","token","localStorage","getItem","consultarAPI","get","headers","Authorization","clientesConsulta","console","log","data","response","status","push","Subject","Description","start","dateend","hour","cliente","guardarCliente","actualizarState","e","target","name","value","agregarCliente","preventDefault","Ticket","Usuarios","users","post","then","res","fire","type","title","text","mensaje","validarCliente","user","valido","length","setuser","setUsers","id","uses","setUses","asignar","splice","arrFiltrado","filter","num","columna","selector","sortable","cell","Finish","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","result","event","test","key","parseInt","map","usuario","index"],"mappings":"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","sourcesContent":["import React, {Fragment, useState, useEffect} from 'react';\r\nimport Swal from 'sweetalert2';\r\nimport { Link, withRouter } from 'react-router-dom';\r\nimport clienteAxios from '../../config/axios';\r\nimport DataTable from 'react-data-table-component';\r\nimport nextId from \"react-id-generator\";\r\n\r\nfunction NuevoTicket({history}){\r\n\r\n    const [ usuarios, guardarUsuarios ] = useState([]);\r\n\r\n    useEffect( () => {\r\n\r\n       let token = localStorage.getItem('token', token);\r\n            // Query a la API\r\n            const consultarAPI = async () => {\r\n               \r\n                try {\r\n                    const clientesConsulta = await clienteAxios.get('/clientes', {\r\n                        headers: {\r\n                            Authorization : `Bearer ${token}`\r\n                        }\r\n                    });\r\n                    \r\n                    console.log(clientesConsulta);\r\n                    // colocar el resultado en el state\r\n                    guardarUsuarios(clientesConsulta.data);\r\n                    \r\n\r\n                } catch (error) {\r\n                    // Error con authorizacion\r\n                    if(error.response.status = 500) {\r\n                       history.push('/iniciar-sesion');\r\n                    }\r\n                }\r\n            }\r\n            consultarAPI();\r\n        \r\n    }, [] );\r\n\r\n\r\n\r\n\r\n    // cliente = state, guardarcliente = funcion para guardar el state\r\n    const[cliente, guardarCliente] = useState({\r\n        Subject: '',\r\n        Description: '',\r\n        start : '',\r\n        dateend: '',\r\n        hour: ''\r\n    });\r\n\r\n    // leer los datos del formulario\r\n    const actualizarState = e => {\r\n        // Almacenar lo que el usuario escribe en el state\r\n        guardarCliente({\r\n            // obtener una copia del state actual\r\n            ...cliente, \r\n            [e.target.name] : e.target.value\r\n        })\r\n\r\n    }\r\n\r\n    // Añade en la REST API un cliente nuevo\r\n    const agregarCliente = e => {\r\n        e.preventDefault();\r\n\r\n\r\n        var Ticket = {};\r\n        Ticket.cliente =cliente;\r\n        Ticket.Usuarios = users; \r\n        // enviar petición\r\n        clienteAxios.post('/Tickets', Ticket,{\r\n            headers: {\r\n                Authorization : `Bearer ${localStorage.getItem('token')}`\r\n            }\r\n        })\r\n            .then(res => {\r\n                // validar si hay errores de mongo \r\n                if(res.data ==='No Autenticado, no hay JWT') {\r\n                    Swal.fire({\r\n                        type: 'error',\r\n                        title: 'Hubo un error',\r\n                        text: 'Token expirado o no existe'\r\n                    })\r\n                    history.push('/iniciar-sesion');\r\n                } else {\r\n                    Swal.fire(\r\n                        'Se agregó el Cliente',\r\n                        res.data.mensaje,\r\n                        'success'\r\n                    )\r\n                }\r\n                // Redireccionar\r\n                history.push('/');\r\n            });\r\n    }\r\n\r\n    // Validar el formulario\r\n    const validarCliente = () => {\r\n        // Destructuring\r\n        const {Subject, Description, start, dateend, user} = cliente;\r\n\r\n        // revisar que las propiedades del state tengan contenido\r\n        let valido = !Subject.length || !Description.length || !start.length || !dateend.length;\r\n\r\n        // return true o false\r\n        return valido;\r\n    }\r\n\r\n    //asignar usuario\r\n  \r\n\r\n    // verificar si el usuario esta autenticado o no\r\n    if(localStorage.getItem('token') ===''  ) {\r\n        history.push('/iniciar-sesion');\r\n    }\r\n\r\n    const [user, setuser] = useState(0);\r\n    const [users,setUsers] = useState(['0']);\r\n    const [uses,setUses] = useState({id:0});\r\n  //  const [guardaruser, setguardaruser] = useState(guardaruser);\r\n    const asignar =(id)=>{\r\n\r\n\r\n      \r\n\r\n\r\n        setUsers(users => [...users, id]);\r\n\r\n        if(users.length ==2){\r\n            users.splice(0,1)\r\n        }else{\r\n            users.splice(0,1)\r\n            const arrFiltrado = users.filter(num => num % 2 == 0)\r\n            users.splice(arrFiltrado,1)\r\n        }\r\n        \r\n        \r\n        \r\n        console.log(users)\r\n       \r\n        \r\n    }\r\n\r\n    const columna = [\r\n        {\r\n         name: 'ID',\r\n         selector: 'id',\r\n         sortable: true\r\n        },\r\n        \r\n        {\r\n         name: 'action',\r\n         cell: (id ) => (\r\n             <>          \r\n \r\n             <span onClick={() => Finish(id)} className='btn btn-verde'>E</span>\r\n           </>\r\n         ),\r\n        }\r\n       \r\n    ] \r\n\r\n    const Finish = (id) => {\r\n        Swal.fire({\r\n            title: '¿Estás seguro?',\r\n            text: \"Seguro quieres Finalizar este Ticket?\",\r\n            type: 'warning',\r\n            showCancelButton: true,\r\n            confirmButtonColor: '#3085d6',\r\n            cancelButtonColor: '#d33',\r\n            confirmButtonText: 'Si, Finalizar',\r\n            cancelButtonText : 'No, Cancelar'\r\n        }).then((result) => {\r\n            \r\n            if (result.value) {\r\n             \r\n                 clienteAxios.post('/Ticket',id, {\r\n                    headers: {\r\n                        Authorization : `Bearer ${localStorage.getItem('token')}`\r\n                    }\r\n                }).then(res => {\r\n                    console.log(res)\r\n                    if(res.status === 200) {\r\n                        Swal.fire(\r\n                            'Eliminado',\r\n                            res.data.mensaje,\r\n                            'success'\r\n                        )\r\n                       \r\n                    }else{\r\n                       history.push('/iniciar-sesion');\r\n                    }\r\n                })\r\n            }\r\n        })\r\n    };\r\n\r\n    return (\r\n\r\n\r\n        <Fragment>\r\n\r\n            <Link to={\"/\"} className=\"btn btn-verde nvo-cliente\">                \r\n               Home\r\n           </Link>\r\n\r\n            <h2>Nuevo Ticket</h2>\r\n            \r\n            <form\r\n                onSubmit={agregarCliente}\r\n            >\r\n                <legend>Llena todos los campos</legend>\r\n                <div className=\"campo\">\r\n                    <label>Subject:</label>\r\n                    <input  type=\"text\" \r\n                            placeholder=\"Subject\" \r\n                            name=\"Subject\"\r\n                            onChange={actualizarState}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"campo\">\r\n                    <label>Description:</label>\r\n                    <input type=\"text\" \r\n                          placeholder=\"Description\" \r\n                          name=\"Description\" \r\n                          onChange={actualizarState}\r\n                    />\r\n                </div>\r\n            \r\n                <div className=\"campo\">\r\n                    <label>date start:</label>\r\n                    <input type=\"date\" \r\n                          placeholder=\"Empresa Cliente\" \r\n                          name=\"start\" \r\n                          onChange={actualizarState}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"campo\">\r\n                    <label>date end:</label>\r\n                    <input type=\"date\" \r\n                            placeholder=\"Email Cliente\" \r\n                            name=\"dateend\" \r\n                            onChange={actualizarState}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"campo\">\r\n                    <label>hour:</label>\r\n                    <input type=\"text\" \r\n                          onKeyPress={(event) => {\r\n                            if (!/[0-9]/.test(event.key)) {\r\n                              event.preventDefault();\r\n                            }\r\n                        }}\r\n                            placeholder=\"Hour\" \r\n                            name=\"hour\" \r\n                            onChange={actualizarState}\r\n                    />\r\n                </div>\r\n\r\n           \r\n\r\n                <div className=\"campo left\">\r\n                    \r\n                  <label>Usuario:</label>\r\n                    <select\r\n                        className=\"campo\"\r\n                        name=\"user\"\r\n                        value={user}\r\n                        onChange={(e) => {\r\n                        const user = e.target.value;\r\n                        setuser(user);\r\n                           \r\n                            if(users.length>1){\r\n\r\n                                setUsers([...users,parseInt(user)]);\r\n                                console.log(users)\r\n                            }else{\r\n                             // setUsers([0]);\r\n                             \r\n                              setUsers([...users,parseInt(user)]);\r\n                              console.log(users)\r\n                            }\r\n                        }}\r\n                    >\r\n                    <option value=\"0\">Seleccionar</option>\r\n                    {usuarios.map((usuario, index) => (\r\n                        \r\n                          <option key={usuario.id} value={usuario.id}>{usuario.name}</option>\r\n                    ))}\r\n                        \r\n                        \r\n\r\n                    </select>\r\n\r\n                  \r\n\r\n                    <button \r\n                        type=\"button\" \r\n                        className=\"right \"\r\n                        onClick={() => asignar(user)}\r\n                      >+\r\n                       </button>\r\n                  \r\n                </div>\r\n                <br/>\r\n                \r\n                    <DataTable\r\n                        columns={columna}\r\n                        data={uses}\r\n                        title='Listado De user'\r\n                        key={nextId()}\r\n                   />\r\n                    \r\n               \r\n\r\n             \r\n\r\n                <div className=\"enviar\">\r\n                    <input \r\n                        type=\"submit\" \r\n                        className=\"btn btn-azul\" \r\n                        value=\"Crear Ticket\" \r\n                        disabled={ validarCliente() }\r\n                    />\r\n                </div>\r\n            </form>\r\n        </Fragment>\r\n    )\r\n}\r\n\r\n// HOC, es una función que toma un componente y retorna un nuevo componente\r\nexport default  withRouter(NuevoTicket);"]},"metadata":{},"sourceType":"module"}